# 品質ゲート定義（QG）

> 各フェーズ移行時のチェック項目を定義する

| 項目 | 値 |
|------|-----|
| ステータス | Draft |
| 作成日 | 2026-01-30 |
| 関連Issue | #69, #71 |

---

## 1. 概要

品質ゲートは、各フェーズから次のフェーズへ移行する際の**必須チェック項目**である。
全項目をクリアしない限り、次フェーズへの移行は認めない。

---

## 2. フェーズ移行ゲート

### QG-1: 要件定義 → 基本設計

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 全要件にIDが付与されている | Arch |
| 2 | 各要件に優先度（P0/P1/P2/Deferred）が設定されている | PO |
| 3 | 各要件に受入条件（AC）が定義されている | PO |
| 4 | スコープ（やる/やらない）が明示されている | PO |
| 5 | 用語の定義が統一されている | Arch |
| 6 | ステークホルダーのレビュー・承認を得ている | PO |
| 7 | RDファイルが100行以下である（コンテキスト最適化） | Arch |

---

### QG-2: 基本設計 → 詳細設計

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 全要件（RD）がいずれかのモジュールに割り当てられている | Arch |
| 2 | モジュール間の依存方向が明確で循環がない | Arch |
| 3 | 各モジュールのI/F（入力/出力/イベント）が定義されている | Arch |
| 4 | 非機能要件の実現方針が記載されている | Arch |
| 5 | トレース（←RD）が記載されている | Arch |
| 6 | アーキテクトのレビュー・承認を得ている | PL |
| 7 | BDファイルが100行以下である（コンテキスト最適化） | Arch |

---

### QG-3: 詳細設計 → 実装

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 全モジュール（BD）の内部設計が記載されている | Arch |
| 2 | 全公開関数のシグネチャ・入出力が定義されている | Dev |
| 3 | エラーケースが網羅されている | Dev |
| 4 | 境界条件が明示されている | Dev |
| 5 | 実装者が「何を書けばいいか」迷わないレベルである | Dev |
| 6 | トレース（←BD）が記載されている | Arch |
| 7 | 開発リーダーのレビュー・承認を得ている | PL |
| 8 | DDファイルが100行以下である（コンテキスト最適化） | Arch |

---

### QG-4: 実装 → 単体テスト

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | ビルドが通る（エラー・警告なし） | Dev |
| 2 | 静的解析（cargo clippy）が通る | Dev |
| 3 | フォーマット（cargo fmt）が適用されている | Dev |
| 4 | DDに記載のない実装がない（勝手な追加禁止） | Arch |
| 5 | コードレビューを受けている | Arch |
| 6 | AI生成の場合、メタ情報が記録されている | Dev |

---

### QG-5: 単体テスト → 結合テスト

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 全UTテストケースがPASS | Dev |
| 2 | DDの全関数にテストが存在する | Arch |
| 3 | 正常系・異常系・境界条件がカバーされている | QA |
| 4 | トレース（←DD）が記載されている | Arch |
| 5 | カバレッジ目標を満たしている（目安: 80%） | QA |

---

### QG-6: 結合テスト → システムテスト

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 全ITテストケースがPASS | QA |
| 2 | 全モジュール間I/F（BD定義）のテストが存在する | Arch |
| 3 | イベントの疎通・順序が正しい | QA |
| 4 | トレース（←BD）が記載されている | Arch |

---

### QG-7: システムテスト → リリース

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 全STテストケースがPASS | QA |
| 2 | 全要件（RD）に対応するSTが存在する | PO |
| 3 | 全P0要件のSTがPASS | PO |
| 4 | 受入条件がすべて満たされている | PO |
| 5 | トレース（←RD）が記載されている | Arch |
| 6 | 顧客/POのレビュー・承認を得ている | PO |
| 7 | トレーサビリティマトリクスが更新されている | Arch |

---

## 3. ステアリング運用ゲート

### QG-S1: Draft → Review

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | メタ情報が記入されている | Dev |
| 2 | ストーリー（背景・目的）が記載されている | Dev |
| 3 | 段取り（起票者・日付）が記録されている | Dev |
| 4 | 差分仕様（RD/DD/UT追加分）が記載されている | Dev |
| 5 | トレーサビリティ（影響範囲）が記載されている | Dev |

---

### QG-S2: Review → Approved

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 要件の記述が明確か | Arch |
| 2 | 詳細設計で実装者が迷わないか | Arch |
| 3 | テストケースが網羅的か | QA |
| 4 | 既存仕様との整合性があるか | Arch |
| 5 | レビュアーの承認記録がある | PL |

---

### QG-S3: Approved → Merged

| # | チェック項目 | 確認者 |
|---|-------------|--------|
| 1 | 実装が完了している | Dev |
| 2 | コードレビューを受けている | Arch |
| 3 | 関連テストがPASS | QA |
| 4 | 本体仕様書（RD/DD/UT）への反映準備ができている | Dev |
| 5 | 承認者の承認記録がある | PL |

---

## 4. コンテキスト最適化ゲート

各ドキュメント作成時に確認：

| # | チェック項目 |
|---|-------------|
| 1 | ドキュメントは100行以下か（目安） |
| 2 | 1ドキュメント = 1関心事になっているか |
| 3 | 正本（Source of Truth）が明示されているか |
| 4 | 関連ドキュメントへの参照（トレース）があるか |
| 5 | index.mdから辿れるか |

---

## 5. 参照ドキュメント

| ドキュメント | 説明 |
|-------------|------|
| [プロセス定義書](v-model.md) | V字モデル・成果物定義 |
| [トレーサビリティマトリクス](traceability.md) | 要件↔設計↔テスト対応表 |

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 作成者 |
|------|-----------|---------|--------|
| 2026-01-30 | 1.0 | 初版作成 | @MasanoriSuda + Claude Code |
