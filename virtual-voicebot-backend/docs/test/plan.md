# テスト計画書

> Virtual Voicebot Backend のテスト計画

| 項目 | 値 |
|------|-----|
| ステータス | Draft |
| 作成日 | 2026-01-31 |
| 関連Issue | #69, #77, #78, #79 |

---

## 1. 概要

### 1.1 目的

本ドキュメントは、Virtual Voicebot Backend のテスト戦略・計画を定義する。

### 1.2 テストレベル

| レベル | 目的 | 対応設計 | 格納先 |
|--------|------|---------|--------|
| 単体テスト（UT） | 詳細設計どおりに動くか | DD | test/unit/ |
| 結合テスト（IT） | モジュール連携が正しいか | BD | test/integration/ |
| システムテスト（ST） | 要件を満たすか | RD | test/system/ |

---

## 2. ディレクトリ構造

```
test/
├── plan.md              # 本ファイル（テスト計画）
├── unit/                # 単体テスト仕様
│   ├── TEMPLATE-UT.md
│   └── UT-xxx.md
├── integration/         # 結合テスト仕様
│   ├── TEMPLATE-IT.md
│   └── IT-xxx.md
└── system/              # システムテスト仕様
    ├── TEMPLATE-ST.md
    └── ST-xxx.md
```

---

## 3. テスト戦略

### 3.1 単体テスト（UT）

| 項目 | 内容 |
|------|------|
| 対象 | 各関数/メソッド |
| 手法 | ホワイトボックス |
| カバレッジ目標 | 80% 以上（重要パスは 100%） |
| 実行タイミング | PR 時（CI） |
| フレームワーク | Jest / Vitest |

### 3.2 結合テスト（IT）

| 項目 | 内容 |
|------|------|
| 対象 | モジュール間 I/F |
| 手法 | グレーボックス |
| 観点 | 正常系/異常系/境界値 |
| 実行タイミング | PR マージ後（CI） |
| フレームワーク | Jest + Supertest |

### 3.3 システムテスト（ST）

| 項目 | 内容 |
|------|------|
| 対象 | システム全体（End-to-End） |
| 手法 | ブラックボックス |
| 観点 | 受入条件の検証 |
| 実行タイミング | リリース前 |
| フレームワーク | SIPP / 手動 |

---

## 4. テスト環境

### 4.1 UT/IT 環境

| 項目 | 内容 |
|------|------|
| 実行環境 | CI（GitHub Actions） |
| モック | 外部依存はモック化 |
| DB | In-memory / テスト用コンテナ |

### 4.2 ST 環境

| 項目 | 内容 |
|------|------|
| 実行環境 | ステージング環境 |
| 外部連携 | 実際の Asterisk / AI サービス |
| データ | テストデータセット |

---

## 5. トレーサビリティ

```
RD-xxx（要件） ←→ ST-xxx（システムテスト）
    ↓
BD-xxx（基本設計） ←→ IT-xxx（結合テスト）
    ↓
DD-xxx（詳細設計） ←→ UT-xxx（単体テスト）
```

詳細は [トレーサビリティマトリクス](../process/traceability.md) を参照。

---

## 6. 品質基準

### 6.1 合格基準

| テストレベル | 合格基準 |
|-------------|---------|
| UT | 全テストパス + カバレッジ 80% |
| IT | 全テストパス |
| ST | 全受入条件パス |

### 6.2 欠陥管理

| 重要度 | 定義 | 対応 |
|--------|------|------|
| Critical | システム停止 | 即時修正必須 |
| Major | 主要機能障害 | リリース前修正必須 |
| Minor | 軽微な問題 | 次回リリースで対応可 |

---

## 7. 参照

- [プロセス定義書](../process/v-model.md) - §4.5, §4.6, §4.7
- [品質ゲート定義](../process/quality-gate.md) - QG-4, QG-5, QG-6
